# Docker的常用命令

具体看官方帮助文档：`https://docs.docker.com/reference/cli/docker/`

### 帮助命令

```shell
docker version            #显示docker的版本信息
docker info               #显示docker的系统信息包括镜像和容器的数量
docker [命令] --help       #命令提示大全
```

### 镜像命令

**docker images / docker image ls 查看所有本地主机上的镜像**

```shell
[root@mantouCentOS7 ~]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
hello-world   latest    d2c94e258dcb   12 months ago   13.3kB
[root@mantouCentOS7 ~]# docker image ls
REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
hello-world   latest    d2c94e258dcb   12 months ago   13.3kB
#解释
1.REPOSITORY（仓库）：表示镜像所属的仓库或来源。在示例中，镜像的仓库名称是"hello-world"，表示这个镜像是从名为"hello-world"的仓库获取的。
2.TAG（标签）：表示镜像的标签或版本号。标签通常用于区分不同版本的镜像。在示例中，镜像的标签是"latest"，表示这是"hello-world"镜像的最新版本。
3.IMAGE ID（镜像ID）：表示镜像的唯一标识符。每个镜像都有一个唯一的ID，用于在Docker系统中进行识别和引用。
4.CREATED（创建时间）：表示镜像的创建时间。在示例中，这个镜像是在12个月前创建的。
5.SIZE（大小）：表示镜像的大小。大小以字节为单位，用于指示镜像在磁盘上占用的空间。
#可选项
-a, -all      #显示所有的镜像，比原本多列出了中间镜像（临时的镜像）和未标记镜像（没有tag标签）
--digests     #显示摘要，摘要是一个唯一标识符，确保镜像唯一
-q, --quiet   #显示镜像id
```

**docker search 搜索镜像**

```shell
[root@mantouCentOS7 ~]# docker search mysql
NAME                            DESCRIPTION                                      STARS     OFFICIAL
mysql                           MySQL is a widely used, open-source relation…   15079     [OK]
mariadb                         MariaDB Server is a high performing open sou…   5749      [OK]
#可选项
-f,--filter # 过滤搜索   docker search --filter=stars=6000 mysql 搜索stars大于等于6000的mysql
```

**docker pull / docker image pull 下载镜像**

```shell
# 用法 docker pull 镜像名[:tag]  不写tag默认最新版本
[root@mantouCentOS7 ~]# docker pull mysql
Using default tag: latest
latest: Pulling from library/mysql
fcbdc4090331: Pull complete #分层下载
95eb5073c36f: Pull complete 
5e5ba0e6412a: Pull complete 
ee4654eb29b7: Pull complete 
1d2218160b86: Pull complete 
bbe712936412: Pull complete 
4a6efa152609: Pull complete 
0f7c3b67bb2b: Pull complete 
7ccd17e83c8a: Pull complete 
04bf2c116556: Pull complete 
Digest: sha256:4a4e5e2a19aab7a67870588952e8f401e17a330466ecfc55c9acf51196da5bd0
Status: Downloaded newer image for mysql:latest
docker.io/library/mysql:latest  #真实地址


#docker pull mysql == docker pull docker.io/library/mysql:latest
#下载其他版本
[root@mantouCentOS7 ~]# docker image pull mysql:8.0
```

**docker rmi 删除镜像**

```shell
[root@mantouCentOS7 ~]# docker rmi c5f0c876cdb1
Untagged: mysql:8.0
Untagged: mysql@sha256:aba83ec239df64820f61f0436b30c17922cf3cc183878ad4e479950bbedd448e
Deleted: sha256:c5f0c876cdb1a18b4dfc8acd83604a6c2df737319e6524f1d7825d3aea87e7e4
Deleted: sha256:3f9817f6680d17108b1d70f60f3245a31c745100152a87c59456304f0005df07
Deleted: sha256:e807c0b5eb510c098177c932a22e4e0aae64d8fdfd8dd28bcc76706edc99ea41
Deleted: sha256:fdb90627a98fdc4b6395214c8605f4499ffb2fc7a9d9df3aa4fc735c24e2ffd7
Deleted: sha256:8f92b55913e33db3750a28f3f2ceb4d12ca3c5118840abcd62e4232aef846398
Deleted: sha256:dfb7fe990190cca978849745501cdc6b331b96b7caf5e59b657393dca6e118ef
Deleted: sha256:bc0fd33c9d9dd7d3515a72f9d0cf00b23ca95abe0c27cdee3d6828e3956c610b
Deleted: sha256:6c2b6f3e52373218ce4e8b5dc86c89a895974b98c6371cf57c335173b7b54c09
Deleted: sha256:44d5781f92718aa12091d3ca77bce93c14f0b3a20e2a275edf0d58922c52dbb3
Deleted: sha256:f7115da85f1b096f3b4f039dfc44aad2e59002a197a57496ee0ab5d25bbc0130
Deleted: sha256:2a0de378b43af70fd500d214770b9a3991486984f4647c3f972b49cae80b4f90
#部分可选项
-f     # 强制删除
#例子
docker rmi -f [id]   # 删除指定镜像
docker rmi -f [id] [id] [id] # 删除多个镜像
docker rmi -f $(docker images -aq) #删除全部的镜像
```

### 容器命令

首先下载一个centos镜像来测试学习

`docker pull centos`

**docker run 新建并启动一个容器**

```shell
docker run [可选参数] [镜像名]
#部分可选参数
--name="NAME" #容器的名字 用来区分容器
-d / --detach #在后台运行并打印容器id
#当使用docker run -d命令以后台模式（detached mode）启动容器时，如果容器中没有正在运行的前台进程，容器会在启动后立即退出。这是因为Docker容器的生命周期与其内部运行的进程（或命令）相关联。
#在Docker中，容器的主要目的是运行一个或多个进程，这些进程作为容器的主要活动。当容器中的主要进程退出或停止时，Docker认为容器的主要任务已完成，因此容器会自动停止。
-it           #使用交互方式运行，进入容器
-p            #将容器的端口发布到主机
-P            #将所有暴露的端口发布到随机端口
[root@mantouCentOS7 ~]# docker run -it  centos /bin/bash 
```

**docker ps 列出正在运行的容器**

```shell
#选项
-a, --all       #显示所有容器（默认是刚刚运行过的）
-q, --quiet     #显示容器id
-s, --size      #显示总文件大小
-n, --list      #显示最后创建的n个容器
```

**退出容器**

```shell
exit      #退出容器
ctrl + p + q #退出并后台运行容器
```

**docker rm  删除容器**

```shell
docker rm 容器id   #删除指定的容器，删除正在运行的用 rm-f强制删除
docker rm -f $(docker ps -aq) #删除所有的容器
```

**启动和停止容器**

```shell
docker start 容器id     #启动容器
docker restart 容器id   #重启容器
docker stop  容器id     #停止容器
docker kill 容器id      #强制停止运行容器
```

## 其他命令

**docker logs 查看日志**

```shell
选项（Options）:
    --details 显示传递给日志的额外细节
-f, --follow 跟随日志输出
    --since string 显示从指定时间戳开始的日志（例如："2013-01-02T13:23:37Z"）或相对时间（例如："42m" 表示 42 分钟）
-n, --tail string 显示日志末尾的行数（默认为 "all"，显示全部日志）
-t, --timestamps 显示时间戳
    --until string 显示在指定时间戳之前的日志（例如："2013-01-02T13:23:37Z"）或相对时间（例如："42m" 表示 42 分钟）
```

1. `-f`选项，或者全写`--follow`，用于跟随日志输出。当使用该选项时，`docker logs`命令将不会立即返回，而是持续监视容器的日志输出，并将其实时显示在终端上。这对于查看实时日志非常有用，可以像流式传输一样观察容器的日志输出。

2. `-t`选项，或者全写`--timestamps`，用于显示日志输出的时间戳。当使用该选项时，每条日志消息的前面将显示时间戳，指示该消息生成的时间。这有助于确定日志事件的发生顺序和时间间隔。

    一般我们看日志可以把-ft都带上，或者带个-n显示行数

    `docker logs -tf -n 10 [容器id]`

**docker top [容器id] 查看容器内的进程信息**

`docker top [容器id]`

**docker inspect 用于检查 Docker 容器、镜像、网络等对象的命令。**

它提供了有关指定对象的详细信息，包括其配置、状态、网络设置等。

1. 检查容器的信息：
   
   ```shell
   docker inspect <容器名或容器ID>
   ```

2. 检查镜像的信息：
   
   ```shell
   docker inspect <镜像名或镜像ID>
   ```

3. 检查网络的信息：
   
   ```shell
   docker inspect <网络名或网络ID>
   ```

**进入当前正在运行的容器**

**方式一 docker exec -it bashshell**

进入容器，开启新进程

```shell
[root@mantouCentOS7 ~]# docker run -d centos /bin/sh -c "while true;do echo bin; sleep 2;done"
df7677d879e2b152381f05b435d6b7b5247375d7bdebcff5ad02cbe03eec7718
[root@mantouCentOS7 ~]# docker ps
CONTAINER ID   IMAGE     COMMAND                   CREATED         STATUS         PORTS     NAMES
df7677d879e2   centos    "/bin/sh -c 'while t…"   2 seconds ago   Up 2 seconds             laughing_knuth
[root@mantouCentOS7 ~]# docker exec -it df7677d879e2 /bin/bash
[root@df7677d879e2 /]# ls
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
[root@df7677d879e2 /]# exit
```

**方式二 docker attach**

```shell
docker attach [容器id]
```

进入标准输入，输出的终端，不开启新进程

**docker cp 用于在本地系统和正在运行的 Docker 容器之间复制文件或目录的命令**

拷贝主机文件到容器

- `docker cp <源路径> <容器名称或ID>:<目标路径>`

拷贝容器文件到主机

- `docker cp <容器名称或ID>:<源路径> <目标路径>`

# 命令图

![](./image/2363254-20211002145236621-74451512.png)
